diff --git a/node_modules/react-native-iap/android/src/play/java/com/dooboolab/rniap/RNIapModule.kt b/node_modules/react-native-iap/android/src/play/java/com/dooboolab/rniap/RNIapModule.kt
index 0000000..1111111 100644
--- a/node_modules/react-native-iap/android/src/play/java/com/dooboolab/rniap/RNIapModule.kt
+++ b/node_modules/react-native-iap/android/src/play/java/com/dooboolab/rniap/RNIapModule.kt
@@ -1,5 +1,6 @@
 package com.dooboolab.rniap
 
+import android.app.Activity
 import android.util.Log
 import com.android.billingclient.api.AcknowledgePurchaseParams
 import com.android.billingclient.api.BillingClient
@@ -516,11 +517,12 @@ class RNIapModule(
         isOfferPersonalized: Boolean, // New parameter in V5
         promise: Promise,
     ) {
-        val activity = currentActivity
-        if (activity == null) {
-            promise.safeReject(PromiseUtils.E_UNKNOWN, "getCurrentActivity returned null")
-            return
-        }
+        // Ensure we have a concrete Activity instance (avoid Any / null issues)
+        val activity: Activity = (getCurrentActivity() ?: reactContext.currentActivity) ?: run {
+            promise.safeReject(PromiseUtils.E_UNKNOWN, "getCurrentActivity returned null")
+            return
+        }
+
         ensureConnection(
             promise,
         ) { billingClient ->
